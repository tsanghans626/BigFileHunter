<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <Fragment>
    <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
      <Component Guid="*">
        <!-- Include all files from publish directory using wildcard -->
        <Files Source="$(var.PublishPath)\**\*" />
      </Component>
    </ComponentGroup>
  </Fragment>

  <Fragment>
    <ComponentGroup Id="ShortcutComponents">
      <!-- Start Menu Shortcut -->
      <Component Guid="*" Directory="ApplicationProgramsFolder">
        <Shortcut Id="StartMenuShortcut"
                  Name="BigFileHunter"
                  Description="Scan directories to identify disk usage patterns"
                  Target="[#BigFileHunter.exe]"
                  WorkingDirectory="INSTALLFOLDER" />
        <RegistryValue Root="HKCU"
                       Key="Software\BigFileHunter"
                       Name="installed"
                       Type="integer"
                       Value="1"
                       KeyPath="yes" />
        <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall" />
      </Component>

      <!-- Desktop Shortcut -->
      <Component Guid="*" Directory="DesktopFolder">
        <Shortcut Id="DesktopShortcut"
                  Name="BigFileHunter"
                  Description="Scan directories to identify disk usage patterns"
                  Target="[#BigFileHunter.exe]"
                  WorkingDirectory="INSTALLFOLDER" />
      </Component>
    </ComponentGroup>
  </Fragment>
</Wix>
